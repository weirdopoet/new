'use strict';var s=require('path');function _interopDefault(e){return e&&e.__esModule?e:{default:e}}var s__default=/*#__PURE__*/_interopDefault(s);var i=class d{constructor(e,t={}){this.path=e;this.meta=t;let r=d.pathToFilePath(e);t.path&&(typeof t.path=="function"?r=t.path(r):r=t.path.replace("{{path}}",r)),this.path=r;}cache={};state={exports:new Map,imports:new Map,symbols:new Map};addExport(e){return this.addImportExport(e,"exports")}addImport(e){return this.addImportExport(e,"imports")}addImportExport(e,t){let r=typeof e.from=="string"?e.from:e.from.path,o=this.state[t].get(r);o?(this.mergeImportExportValues(o,e),this.state[t].set(r,o)):this.state[t].set(r,{...e}),this.cache[t]=void 0;}addSymbol(e){let t=e.name,r=this.state.symbols.get(t);r?(r.value=e.value,this.state.symbols.set(t,r)):this.state.symbols.set(t,{...e}),this.cache.symbols=void 0;}get exports(){return this.cache.exports||(this.cache.exports=Array.from(this.state.exports.values())),this.cache.exports}getAllSymbols(){return [...this.symbols,...this.imports.flatMap(e=>(e.names??[]).map(t=>({name:e.aliases?.[t]??t}))),...this.exports.flatMap(e=>(e.names??[]).map(t=>({name:e.aliases?.[t]??t})))]}hasContent(){return this.state.symbols.size>0||this.state.exports.size>0}hasSymbol(e){return this.state.symbols.has(e)}get imports(){return this.cache.imports||(this.cache.imports=Array.from(this.state.imports.values())),this.cache.imports}mergeImportExportValues(e,t){e.aliases={...e.aliases,...t.aliases},t.defaultImport!==void 0&&(e.defaultImport=t.defaultImport),e.names=[...new Set([...e.names??[],...t.names??[]])],t.namespaceImport!==void 0&&(e.namespaceImport=t.namespaceImport),t.typeDefaultImport!==void 0&&(e.typeDefaultImport=t.typeDefaultImport),e.typeNames=[...new Set([...e.typeNames??[],...t.typeNames??[]])],t.typeNamespaceImport!==void 0&&(e.typeNamespaceImport=t.typeNamespaceImport);}static pathToFilePath(e){return e.includes("/")?e.split("/").filter(Boolean).join(s__default.default.sep):e.includes("\\")?e.split("\\").filter(Boolean).join(s__default.default.sep):e.split(s__default.default.sep).filter(Boolean).join(s__default.default.sep)}relativePathFromFile(e){let t=s__default.default.posix.relative(s__default.default.posix.dirname(e.path),this.path);return t.startsWith(".")||(t=`./${t}`),t}relativePathToFile(e){let t=s__default.default.posix.relative(s__default.default.posix.dirname(this.path),e.path);return t.startsWith(".")||(t=`./${t}`),t}get symbols(){return this.cache.symbols||(this.cache.symbols=Array.from(this.state.symbols.values())),this.cache.symbols}};var a=class{filesMap=new Map;filesOrder=[];renderers=new Map;addExportToFile(e,t){this.ensureFile(e).addExport(t);}addImportToFile(e,t){this.ensureFile(e).addImport(t);}addSymbolToFile(e,t){this.ensureFile(e).addSymbol(t);}createFile(e,t={}){let{renderer:r,...o}=t;r&&this.ensureRenderer(r);let n=this.getFileByPath(e);if(n)return r?.id&&r.id!==n.meta.renderer&&(n.meta.renderer=r.id),n;let p=new i(e,{...o,renderer:r?.id});return this.filesOrder.push(p),this.filesMap.set(e,p),p}ensureFile(e){if(typeof e!="string")return e;let t=this.getFileByPath(e);return t||this.createFile(e)}ensureRenderer(e){return this.renderers.has(e.id)||this.renderers.set(e.id,e),this.renderers.get(e.id)}get files(){return [...this.filesOrder]}getAllSymbols(){return this.filesOrder.flatMap(e=>e.getAllSymbols())}getFileByPath(e){return this.filesMap.get(e)}render(e){let t=[];for(let r of this.filesOrder){if(!r.meta.renderer)continue;let o=this.renderers.get(r.meta.renderer);o&&t.push(o.render(r,e));}return t}};exports.CodegenFile=i;exports.CodegenProject=a;//# sourceMappingURL=index.cjs.map
//# sourceMappingURL=index.cjs.map